Enhanced Trading Journal Framework with Sentiment & Conversation Integration

VARIABLES
- DATE: {DATE}
- CSV_URL: {CSV_URL}
- INSTRUMENT_FILTER: {INSTRUMENT_FILTER}
- TOPSTEP_PROGRAM: {TOPSTEP_PROGRAM}  # e.g., Combine / Express / Funded / None

INSTRUCTIONS (for Perplexity Shortcut)
1) Fetch Trading Data
   - Load CSV from https://github.com/AngryBuhda/Futures-Trading-Profile/blob/2367077b4ad845bb1991c06f26a01fcd3b591794/trades_export%20(3).csv
   - Parse columns: Id, ContractName, EnteredAt, ExitedAt, EntryPrice, ExitPrice, Fees, PnL, Size, Type, TradeDay, TradeDuration
   - Filter rows where TradeDay matches DATE (match by date only, ignore timezone offset)
   - If INSTRUMENT_FILTER is provided, keep only rows with ContractName containing INSTRUMENT_FILTER
   - Sort results by EnteredAt ascending

2) Correlate with Conversations
   - Retrieve today's conversation history
   - Extract trading-related messages (keywords: entry, exit, long, short, plan, bias, risk, stop, target, TopStep, emotions)
   - Create a time-aligned map: for each trade, collect nearby conversation snippets (+/- 30 minutes of EnteredAt/ExitedAt)
   - Detect sentiment/emotion per trade (e.g., confident, anxious, frustrated, disciplined)

3) TopStep-Specific Metrics (if TOPSTEP_PROGRAM != None)
   - Summarize rule compliance: daily loss limit adherence, trailing drawdown usage (estimate via cumulative P&L), scaling/size within program rules
   - Note any potential rule violations or near-misses mentioned in conversations
   - Track evaluation progress or account preservation focus

4) Output Format (use bullet points, concise sentences)

HEADER
- Date: {DATE}
- Session window: [first EnteredAt] to [last ExitedAt]
- Primary instrument(s): [unique ContractName values]
- TopStep program: {TOPSTEP_PROGRAM}
- Summary P&L (gross): [sum PnL]
- Net after fees: [sum PnL - sum Fees]
- Number of trades: [count]

TRADE LOG (one block per trade)
- Trade ID: [Id] | Symbol: [ContractName] | Direction: [Type] | Size: [Size]
- Entry: [EnteredAt] @ [EntryPrice] | Exit: [ExitedAt] @ [ExitPrice]
- Duration: [TradeDuration] | P&L: [PnL] | Fees: [Fees]
- Conversation context: [2–3 short snippets with timestamps]
- Sentiment tags: [e.g., confident, rushed, patient, FOMO, revenge, disciplined]
- Notes: [1–2 observations linking plan vs execution]

SESSION ANALYSIS
- What worked: [patterns, setups, risk discipline that added edge]
- What didn’t: [mistakes, late entries, cutting winners, overtrading]
- Market context: [trend/structure inferred from trade sequence]
- Psychology: [dominant emotions and triggers]
- TopStep compliance: [rule adherence summary and drawdown usage]

METRICS
- Win rate: [wins / total]
- Avg win / Avg loss: [computed]
- Best trade: [Id with reason]
- Worst trade: [Id with reason]
- Time in market: [sum of durations]

NEXT-SESSION PLAYBOOK
- Strategy: [one adjustment to entries/exits/management]
- Risk: [position sizing and stop discipline within TopStep rules]
- Process: [checklist item to reinforce]
- Mindset: [single intention for tomorrow]

NOTES
- If no trades match DATE, output: "No trades found for {DATE}."
- If conversations are sparse, still produce journal using CSV data and add "Conversation context limited today."
- Keep total length focused and skimmable; avoid long paragraphs.